This task is similar to last year's intcode, with some changes, of course.

The solution for the first part is 1087.
